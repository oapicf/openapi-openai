#
# OpenAI API
# 
# The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
# The version of the OpenAPI document: 2.0.0
# Contact: blah+oapicf@cliffano.com
# Generated by: https://openapi-generator.tech
#

import json
import tables
import marshal
import options

import model_create_image_request_model

type Quality* {.pure.} = enum
  Standard
  Hd

type ResponseFormat* {.pure.} = enum
  Url
  B64Json

type Size* {.pure.} = enum
  `256x256`
  `512x512`
  `1024x1024`
  `1792x1024`
  `1024x1792`

type Style* {.pure.} = enum
  Vivid
  Natural

type CreateImageRequest* = object
  ## 
  prompt*: string ## A text description of the desired image(s). The maximum length is 1000 characters for `dall-e-2` and 4000 characters for `dall-e-3`.
  model*: Option[CreateImageRequest_model]
  n*: Option[int] ## The number of images to generate. Must be between 1 and 10. For `dall-e-3`, only `n=1` is supported.
  quality*: Option[Quality] ## The quality of the image that will be generated. `hd` creates images with finer details and greater consistency across the image. This param is only supported for `dall-e-3`.
  responseFormat*: Option[ResponseFormat] ## The format in which the generated images are returned. Must be one of `url` or `b64_json`. URLs are only valid for 60 minutes after the image has been generated.
  size*: Option[Size] ## The size of the generated images. Must be one of `256x256`, `512x512`, or `1024x1024` for `dall-e-2`. Must be one of `1024x1024`, `1792x1024`, or `1024x1792` for `dall-e-3` models.
  style*: Option[Style] ## The style of the generated images. Must be one of `vivid` or `natural`. Vivid causes the model to lean towards generating hyper-real and dramatic images. Natural causes the model to produce more natural, less hyper-real looking images. This param is only supported for `dall-e-3`.
  user*: Option[string] ## A unique identifier representing your end-user, which can help OpenAI to monitor and detect abuse. [Learn more](/docs/guides/safety-best-practices/end-user-ids). 

func `%`*(v: Quality): JsonNode =
  result = case v:
    of Quality.Standard: %"standard"
    of Quality.Hd: %"hd"
func `$`*(v: Quality): string =
  result = case v:
    of Quality.Standard: $("standard")
    of Quality.Hd: $("hd")

proc to*(node: JsonNode, T: typedesc[Quality]): Quality =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Quality, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("standard"):
    return Quality.Standard
  of $("hd"):
    return Quality.Hd
  else:
    raise newException(ValueError, "Invalid enum value for Quality: " & strVal)

func `%`*(v: ResponseFormat): JsonNode =
  result = case v:
    of ResponseFormat.Url: %"url"
    of ResponseFormat.B64Json: %"b64_json"
func `$`*(v: ResponseFormat): string =
  result = case v:
    of ResponseFormat.Url: $("url")
    of ResponseFormat.B64Json: $("b64_json")

proc to*(node: JsonNode, T: typedesc[ResponseFormat]): ResponseFormat =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum ResponseFormat, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("url"):
    return ResponseFormat.Url
  of $("b64_json"):
    return ResponseFormat.B64Json
  else:
    raise newException(ValueError, "Invalid enum value for ResponseFormat: " & strVal)

func `%`*(v: Size): JsonNode =
  result = case v:
    of Size.`256x256`: %"256x256"
    of Size.`512x512`: %"512x512"
    of Size.`1024x1024`: %"1024x1024"
    of Size.`1792x1024`: %"1792x1024"
    of Size.`1024x1792`: %"1024x1792"
func `$`*(v: Size): string =
  result = case v:
    of Size.`256x256`: $("256x256")
    of Size.`512x512`: $("512x512")
    of Size.`1024x1024`: $("1024x1024")
    of Size.`1792x1024`: $("1792x1024")
    of Size.`1024x1792`: $("1024x1792")

proc to*(node: JsonNode, T: typedesc[Size]): Size =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Size, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("256x256"):
    return Size.`256x256`
  of $("512x512"):
    return Size.`512x512`
  of $("1024x1024"):
    return Size.`1024x1024`
  of $("1792x1024"):
    return Size.`1792x1024`
  of $("1024x1792"):
    return Size.`1024x1792`
  else:
    raise newException(ValueError, "Invalid enum value for Size: " & strVal)

func `%`*(v: Style): JsonNode =
  result = case v:
    of Style.Vivid: %"vivid"
    of Style.Natural: %"natural"
func `$`*(v: Style): string =
  result = case v:
    of Style.Vivid: $("vivid")
    of Style.Natural: $("natural")

proc to*(node: JsonNode, T: typedesc[Style]): Style =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Style, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("vivid"):
    return Style.Vivid
  of $("natural"):
    return Style.Natural
  else:
    raise newException(ValueError, "Invalid enum value for Style: " & strVal)


# Custom JSON deserialization for CreateImageRequest with custom field names
proc to*(node: JsonNode, T: typedesc[CreateImageRequest]): CreateImageRequest =
  result = CreateImageRequest()
  if node.kind == JObject:
    if node.hasKey("prompt"):
      result.prompt = to(node["prompt"], string)
    if node.hasKey("model") and node["model"].kind != JNull:
      result.model = some(to(node["model"], typeof(result.model.get())))
    if node.hasKey("n") and node["n"].kind != JNull:
      result.n = some(to(node["n"], typeof(result.n.get())))
    if node.hasKey("quality") and node["quality"].kind != JNull:
      result.quality = some(to(node["quality"], Quality))
    if node.hasKey("response_format") and node["response_format"].kind != JNull:
      result.responseFormat = some(to(node["response_format"], ResponseFormat))
    if node.hasKey("size") and node["size"].kind != JNull:
      result.size = some(to(node["size"], Size))
    if node.hasKey("style") and node["style"].kind != JNull:
      result.style = some(to(node["style"], Style))
    if node.hasKey("user") and node["user"].kind != JNull:
      result.user = some(to(node["user"], typeof(result.user.get())))

# Custom JSON serialization for CreateImageRequest with custom field names
proc `%`*(obj: CreateImageRequest): JsonNode =
  result = newJObject()
  result["prompt"] = %obj.prompt
  if obj.model.isSome():
    result["model"] = %obj.model.get()
  if obj.n.isSome():
    result["n"] = %obj.n.get()
  if obj.quality.isSome():
    result["quality"] = %obj.quality.get()
  if obj.responseFormat.isSome():
    result["response_format"] = %obj.responseFormat.get()
  if obj.size.isSome():
    result["size"] = %obj.size.get()
  if obj.style.isSome():
    result["style"] = %obj.style.get()
  if obj.user.isSome():
    result["user"] = %obj.user.get()

