#
# OpenAI API
# 
# The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
# The version of the OpenAPI document: 2.3.0
# Contact: blah+oapicf@cliffano.com
# Generated by: https://openapi-generator.tech
#

import json
import tables
import marshal
import options

import model_create_speech_request_model

type Voice* {.pure.} = enum
  Alloy
  Echo
  Fable
  Onyx
  Nova
  Shimmer

type ResponseFormat* {.pure.} = enum
  Mp3
  Opus
  Aac
  Flac
  Wav
  Pcm

type CreateSpeechRequest* = object
  ## 
  model*: CreateSpeechRequest_model
  input*: string ## The text to generate audio for. The maximum length is 4096 characters.
  voice*: Voice ## The voice to use when generating the audio. Supported voices are `alloy`, `echo`, `fable`, `onyx`, `nova`, and `shimmer`. Previews of the voices are available in the [Text to speech guide](/docs/guides/text-to-speech#voice-options).
  responseFormat*: Option[ResponseFormat] ## The format to audio in. Supported formats are `mp3`, `opus`, `aac`, `flac`, `wav`, and `pcm`.
  speed*: Option[float] ## The speed of the generated audio. Select a value from `0.25` to `4.0`. `1.0` is the default.

func `%`*(v: Voice): JsonNode =
  result = case v:
    of Voice.Alloy: %"alloy"
    of Voice.Echo: %"echo"
    of Voice.Fable: %"fable"
    of Voice.Onyx: %"onyx"
    of Voice.Nova: %"nova"
    of Voice.Shimmer: %"shimmer"
func `$`*(v: Voice): string =
  result = case v:
    of Voice.Alloy: $("alloy")
    of Voice.Echo: $("echo")
    of Voice.Fable: $("fable")
    of Voice.Onyx: $("onyx")
    of Voice.Nova: $("nova")
    of Voice.Shimmer: $("shimmer")

proc to*(node: JsonNode, T: typedesc[Voice]): Voice =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Voice, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("alloy"):
    return Voice.Alloy
  of $("echo"):
    return Voice.Echo
  of $("fable"):
    return Voice.Fable
  of $("onyx"):
    return Voice.Onyx
  of $("nova"):
    return Voice.Nova
  of $("shimmer"):
    return Voice.Shimmer
  else:
    raise newException(ValueError, "Invalid enum value for Voice: " & strVal)

func `%`*(v: ResponseFormat): JsonNode =
  result = case v:
    of ResponseFormat.Mp3: %"mp3"
    of ResponseFormat.Opus: %"opus"
    of ResponseFormat.Aac: %"aac"
    of ResponseFormat.Flac: %"flac"
    of ResponseFormat.Wav: %"wav"
    of ResponseFormat.Pcm: %"pcm"
func `$`*(v: ResponseFormat): string =
  result = case v:
    of ResponseFormat.Mp3: $("mp3")
    of ResponseFormat.Opus: $("opus")
    of ResponseFormat.Aac: $("aac")
    of ResponseFormat.Flac: $("flac")
    of ResponseFormat.Wav: $("wav")
    of ResponseFormat.Pcm: $("pcm")

proc to*(node: JsonNode, T: typedesc[ResponseFormat]): ResponseFormat =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum ResponseFormat, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("mp3"):
    return ResponseFormat.Mp3
  of $("opus"):
    return ResponseFormat.Opus
  of $("aac"):
    return ResponseFormat.Aac
  of $("flac"):
    return ResponseFormat.Flac
  of $("wav"):
    return ResponseFormat.Wav
  of $("pcm"):
    return ResponseFormat.Pcm
  else:
    raise newException(ValueError, "Invalid enum value for ResponseFormat: " & strVal)


# Custom JSON deserialization for CreateSpeechRequest with custom field names
proc to*(node: JsonNode, T: typedesc[CreateSpeechRequest]): CreateSpeechRequest =
  result = CreateSpeechRequest()
  if node.kind == JObject:
    if node.hasKey("model"):
      result.model = to(node["model"], CreateSpeechRequest_model)
    if node.hasKey("input"):
      result.input = to(node["input"], string)
    if node.hasKey("voice"):
      result.voice = to(node["voice"], Voice)
    if node.hasKey("response_format") and node["response_format"].kind != JNull:
      result.responseFormat = some(to(node["response_format"], ResponseFormat))
    if node.hasKey("speed") and node["speed"].kind != JNull:
      result.speed = some(to(node["speed"], typeof(result.speed.get())))

# Custom JSON serialization for CreateSpeechRequest with custom field names
proc `%`*(obj: CreateSpeechRequest): JsonNode =
  result = newJObject()
  result["model"] = %obj.model
  result["input"] = %obj.input
  result["voice"] = %obj.voice
  if obj.responseFormat.isSome():
    result["response_format"] = %obj.responseFormat.get()
  if obj.speed.isSome():
    result["speed"] = %obj.speed.get()

