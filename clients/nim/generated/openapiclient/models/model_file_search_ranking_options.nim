#
# OpenAI API
# 
# The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
# The version of the OpenAPI document: 2.3.0
# Contact: blah+oapicf@cliffano.com
# Generated by: https://openapi-generator.tech
#

import json
import tables
import marshal
import options


type Ranker* {.pure.} = enum
  Auto
  Default20240821

type FileSearchRankingOptions* = object
  ## The ranking options for the file search. If not specified, the file search tool will use the `auto` ranker and a score_threshold of 0.  See the [file search tool documentation](/docs/assistants/tools/file-search#customizing-file-search-settings) for more information. 
  ranker*: Option[Ranker] ## The ranker to use for the file search. If not specified will use the `auto` ranker.
  scoreThreshold*: float ## The score threshold for the file search. All values must be a floating point number between 0 and 1.

func `%`*(v: Ranker): JsonNode =
  result = case v:
    of Ranker.Auto: %"auto"
    of Ranker.Default20240821: %"default_2024_08_21"
func `$`*(v: Ranker): string =
  result = case v:
    of Ranker.Auto: $("auto")
    of Ranker.Default20240821: $("default_2024_08_21")

proc to*(node: JsonNode, T: typedesc[Ranker]): Ranker =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Ranker, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("auto"):
    return Ranker.Auto
  of $("default_2024_08_21"):
    return Ranker.Default20240821
  else:
    raise newException(ValueError, "Invalid enum value for Ranker: " & strVal)


# Custom JSON deserialization for FileSearchRankingOptions with custom field names
proc to*(node: JsonNode, T: typedesc[FileSearchRankingOptions]): FileSearchRankingOptions =
  result = FileSearchRankingOptions()
  if node.kind == JObject:
    if node.hasKey("ranker") and node["ranker"].kind != JNull:
      result.ranker = some(to(node["ranker"], Ranker))
    if node.hasKey("score_threshold"):
      result.scoreThreshold = to(node["score_threshold"], float)

# Custom JSON serialization for FileSearchRankingOptions with custom field names
proc `%`*(obj: FileSearchRankingOptions): JsonNode =
  result = newJObject()
  if obj.ranker.isSome():
    result["ranker"] = %obj.ranker.get()
  result["score_threshold"] = %obj.scoreThreshold

