#
# OpenAI API
# 
# The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
# The version of the OpenAPI document: 2.3.0
# Contact: blah+oapicf@cliffano.com
# Generated by: https://openapi-generator.tech
#

import json
import tables
import marshal
import options

import model_fine_tune_method
import model_fine_tuning_job_error
import model_fine_tuning_job_hyperparameters
import model_fine_tuning_job_integrations_inner

type `Object`* {.pure.} = enum
  FineTuningJob

type Status* {.pure.} = enum
  ValidatingFiles
  Queued
  Running
  Succeeded
  Failed
  Cancelled

type FineTuningJob* = object
  ## The `fine_tuning.job` object represents a fine-tuning job that has been created through the API. 
  id*: string ## The object identifier, which can be referenced in the API endpoints.
  createdAt*: int ## The Unix timestamp (in seconds) for when the fine-tuning job was created.
  error*: Option[FineTuningJob_error]
  fineTunedModel*: Option[string] ## The name of the fine-tuned model that is being created. The value will be null if the fine-tuning job is still running.
  finishedAt*: Option[int] ## The Unix timestamp (in seconds) for when the fine-tuning job was finished. The value will be null if the fine-tuning job is still running.
  hyperparameters*: FineTuningJob_hyperparameters
  model*: string ## The base model that is being fine-tuned.
  `object`*: `Object` ## The object type, which is always \"fine_tuning.job\".
  organizationId*: string ## The organization that owns the fine-tuning job.
  resultFiles*: seq[string] ## The compiled results file ID(s) for the fine-tuning job. You can retrieve the results with the [Files API](/docs/api-reference/files/retrieve-contents).
  status*: Status ## The current status of the fine-tuning job, which can be either `validating_files`, `queued`, `running`, `succeeded`, `failed`, or `cancelled`.
  trainedTokens*: Option[int] ## The total number of billable tokens processed by this fine-tuning job. The value will be null if the fine-tuning job is still running.
  trainingFile*: string ## The file ID used for training. You can retrieve the training data with the [Files API](/docs/api-reference/files/retrieve-contents).
  validationFile*: Option[string] ## The file ID used for validation. You can retrieve the validation results with the [Files API](/docs/api-reference/files/retrieve-contents).
  integrations*: Option[seq[FineTuningJob_integrations_inner]] ## A list of integrations to enable for this fine-tuning job.
  seed*: int ## The seed used for the fine-tuning job.
  estimatedFinish*: Option[int] ## The Unix timestamp (in seconds) for when the fine-tuning job is estimated to finish. The value will be null if the fine-tuning job is not running.
  `method`*: Option[FineTuneMethod]

func `%`*(v: `Object`): JsonNode =
  result = case v:
    of `Object`.FineTuningJob: %"fine_tuning.job"
func `$`*(v: `Object`): string =
  result = case v:
    of `Object`.FineTuningJob: $("fine_tuning.job")

proc to*(node: JsonNode, T: typedesc[`Object`]): `Object` =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum `Object`, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("fine_tuning.job"):
    return `Object`.FineTuningJob
  else:
    raise newException(ValueError, "Invalid enum value for `Object`: " & strVal)

func `%`*(v: Status): JsonNode =
  result = case v:
    of Status.ValidatingFiles: %"validating_files"
    of Status.Queued: %"queued"
    of Status.Running: %"running"
    of Status.Succeeded: %"succeeded"
    of Status.Failed: %"failed"
    of Status.Cancelled: %"cancelled"
func `$`*(v: Status): string =
  result = case v:
    of Status.ValidatingFiles: $("validating_files")
    of Status.Queued: $("queued")
    of Status.Running: $("running")
    of Status.Succeeded: $("succeeded")
    of Status.Failed: $("failed")
    of Status.Cancelled: $("cancelled")

proc to*(node: JsonNode, T: typedesc[Status]): Status =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Status, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("validating_files"):
    return Status.ValidatingFiles
  of $("queued"):
    return Status.Queued
  of $("running"):
    return Status.Running
  of $("succeeded"):
    return Status.Succeeded
  of $("failed"):
    return Status.Failed
  of $("cancelled"):
    return Status.Cancelled
  else:
    raise newException(ValueError, "Invalid enum value for Status: " & strVal)


# Custom JSON deserialization for FineTuningJob with custom field names
proc to*(node: JsonNode, T: typedesc[FineTuningJob]): FineTuningJob =
  result = FineTuningJob()
  if node.kind == JObject:
    if node.hasKey("id"):
      result.id = to(node["id"], string)
    if node.hasKey("created_at"):
      result.createdAt = to(node["created_at"], int)
    if node.hasKey("error") and node["error"].kind != JNull:
      result.error = some(to(node["error"], typeof(result.error.get())))
    if node.hasKey("fine_tuned_model") and node["fine_tuned_model"].kind != JNull:
      result.fineTunedModel = some(to(node["fine_tuned_model"], typeof(result.fineTunedModel.get())))
    if node.hasKey("finished_at") and node["finished_at"].kind != JNull:
      result.finishedAt = some(to(node["finished_at"], typeof(result.finishedAt.get())))
    if node.hasKey("hyperparameters"):
      result.hyperparameters = to(node["hyperparameters"], FineTuningJob_hyperparameters)
    if node.hasKey("model"):
      result.model = to(node["model"], string)
    if node.hasKey("object"):
      result.`object` = to(node["object"], `Object`)
    if node.hasKey("organization_id"):
      result.organizationId = to(node["organization_id"], string)
    if node.hasKey("result_files"):
      result.resultFiles = to(node["result_files"], seq[string])
    if node.hasKey("status"):
      result.status = to(node["status"], Status)
    if node.hasKey("trained_tokens") and node["trained_tokens"].kind != JNull:
      result.trainedTokens = some(to(node["trained_tokens"], typeof(result.trainedTokens.get())))
    if node.hasKey("training_file"):
      result.trainingFile = to(node["training_file"], string)
    if node.hasKey("validation_file") and node["validation_file"].kind != JNull:
      result.validationFile = some(to(node["validation_file"], typeof(result.validationFile.get())))
    if node.hasKey("integrations") and node["integrations"].kind != JNull:
      result.integrations = some(to(node["integrations"], typeof(result.integrations.get())))
    if node.hasKey("seed"):
      result.seed = to(node["seed"], int)
    if node.hasKey("estimated_finish") and node["estimated_finish"].kind != JNull:
      result.estimatedFinish = some(to(node["estimated_finish"], typeof(result.estimatedFinish.get())))
    if node.hasKey("method") and node["method"].kind != JNull:
      result.`method` = some(to(node["method"], typeof(result.`method`.get())))

# Custom JSON serialization for FineTuningJob with custom field names
proc `%`*(obj: FineTuningJob): JsonNode =
  result = newJObject()
  result["id"] = %obj.id
  result["created_at"] = %obj.createdAt
  if obj.error.isSome():
    result["error"] = %obj.error.get()
  if obj.fineTunedModel.isSome():
    result["fine_tuned_model"] = %obj.fineTunedModel.get()
  if obj.finishedAt.isSome():
    result["finished_at"] = %obj.finishedAt.get()
  result["hyperparameters"] = %obj.hyperparameters
  result["model"] = %obj.model
  result["object"] = %obj.`object`
  result["organization_id"] = %obj.organizationId
  result["result_files"] = %obj.resultFiles
  result["status"] = %obj.status
  if obj.trainedTokens.isSome():
    result["trained_tokens"] = %obj.trainedTokens.get()
  result["training_file"] = %obj.trainingFile
  if obj.validationFile.isSome():
    result["validation_file"] = %obj.validationFile.get()
  if obj.integrations.isSome():
    result["integrations"] = %obj.integrations.get()
  result["seed"] = %obj.seed
  if obj.estimatedFinish.isSome():
    result["estimated_finish"] = %obj.estimatedFinish.get()
  if obj.`method`.isSome():
    result["method"] = %obj.`method`.get()

