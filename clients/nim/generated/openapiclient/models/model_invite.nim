#
# OpenAI API
# 
# The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
# The version of the OpenAPI document: 2.3.0
# Contact: blah+oapicf@cliffano.com
# Generated by: https://openapi-generator.tech
#

import json
import tables
import marshal
import options

import model_invite_projects_inner

type `Object`* {.pure.} = enum
  OrganizationInvite

type Role* {.pure.} = enum
  Owner
  Reader

type Status* {.pure.} = enum
  Accepted
  Expired
  Pending

type Invite* = object
  ## Represents an individual `invite` to the organization.
  `object`*: `Object` ## The object type, which is always `organization.invite`
  id*: string ## The identifier, which can be referenced in API endpoints
  email*: string ## The email address of the individual to whom the invite was sent
  role*: Role ## `owner` or `reader`
  status*: Status ## `accepted`,`expired`, or `pending`
  invitedAt*: int ## The Unix timestamp (in seconds) of when the invite was sent.
  expiresAt*: int ## The Unix timestamp (in seconds) of when the invite expires.
  acceptedAt*: Option[int] ## The Unix timestamp (in seconds) of when the invite was accepted.
  projects*: Option[seq[Invite_projects_inner]] ## The projects that were granted membership upon acceptance of the invite.

func `%`*(v: `Object`): JsonNode =
  result = case v:
    of `Object`.OrganizationInvite: %"organization.invite"
func `$`*(v: `Object`): string =
  result = case v:
    of `Object`.OrganizationInvite: $("organization.invite")

proc to*(node: JsonNode, T: typedesc[`Object`]): `Object` =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum `Object`, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("organization.invite"):
    return `Object`.OrganizationInvite
  else:
    raise newException(ValueError, "Invalid enum value for `Object`: " & strVal)

func `%`*(v: Role): JsonNode =
  result = case v:
    of Role.Owner: %"owner"
    of Role.Reader: %"reader"
func `$`*(v: Role): string =
  result = case v:
    of Role.Owner: $("owner")
    of Role.Reader: $("reader")

proc to*(node: JsonNode, T: typedesc[Role]): Role =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Role, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("owner"):
    return Role.Owner
  of $("reader"):
    return Role.Reader
  else:
    raise newException(ValueError, "Invalid enum value for Role: " & strVal)

func `%`*(v: Status): JsonNode =
  result = case v:
    of Status.Accepted: %"accepted"
    of Status.Expired: %"expired"
    of Status.Pending: %"pending"
func `$`*(v: Status): string =
  result = case v:
    of Status.Accepted: $("accepted")
    of Status.Expired: $("expired")
    of Status.Pending: $("pending")

proc to*(node: JsonNode, T: typedesc[Status]): Status =
  if node.kind != JString:
    raise newException(ValueError, "Expected string for enum Status, got " & $node.kind)
  let strVal = node.getStr()
  case strVal:
  of $("accepted"):
    return Status.Accepted
  of $("expired"):
    return Status.Expired
  of $("pending"):
    return Status.Pending
  else:
    raise newException(ValueError, "Invalid enum value for Status: " & strVal)


# Custom JSON deserialization for Invite with custom field names
proc to*(node: JsonNode, T: typedesc[Invite]): Invite =
  result = Invite()
  if node.kind == JObject:
    if node.hasKey("object"):
      result.`object` = to(node["object"], `Object`)
    if node.hasKey("id"):
      result.id = to(node["id"], string)
    if node.hasKey("email"):
      result.email = to(node["email"], string)
    if node.hasKey("role"):
      result.role = to(node["role"], Role)
    if node.hasKey("status"):
      result.status = to(node["status"], Status)
    if node.hasKey("invited_at"):
      result.invitedAt = to(node["invited_at"], int)
    if node.hasKey("expires_at"):
      result.expiresAt = to(node["expires_at"], int)
    if node.hasKey("accepted_at") and node["accepted_at"].kind != JNull:
      result.acceptedAt = some(to(node["accepted_at"], typeof(result.acceptedAt.get())))
    if node.hasKey("projects") and node["projects"].kind != JNull:
      result.projects = some(to(node["projects"], typeof(result.projects.get())))

# Custom JSON serialization for Invite with custom field names
proc `%`*(obj: Invite): JsonNode =
  result = newJObject()
  result["object"] = %obj.`object`
  result["id"] = %obj.id
  result["email"] = %obj.email
  result["role"] = %obj.role
  result["status"] = %obj.status
  result["invited_at"] = %obj.invitedAt
  result["expires_at"] = %obj.expiresAt
  if obj.acceptedAt.isSome():
    result["accepted_at"] = %obj.acceptedAt.get()
  if obj.projects.isSome():
    result["projects"] = %obj.projects.get()

