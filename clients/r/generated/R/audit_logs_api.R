#' OpenAI API
#'
#' The OpenAI REST API. Please see https://platform.openai.com/docs/api-reference for more details.
#'
#' The version of the OpenAPI document: 2.3.0
#' Contact: blah+oapicf@cliffano.com
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title AuditLogs operations
#' @description AuditLogsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @examples
#' \dontrun{
#' ####################  ListAuditLogs  ####################
#'
#' library(openapi)
#' var_effective_at <- list_audit_logs_effective_at_parameter$new(123, 123, 123, 123) # ListAuditLogsEffectiveAtParameter | Return only events whose `effective_at` (Unix seconds) is in this range. (Optional)
#' var_project_ids <- c("inner_example") # array[character] | Return only events for these projects. (Optional)
#' var_event_types <- c(AuditLogEventType$new()) # array[AuditLogEventType] | Return only events with a `type` in one of these values. For example, `project.created`. For all options, see the documentation for the [audit log object](/docs/api-reference/audit-logs/object). (Optional)
#' var_actor_ids <- c("inner_example") # array[character] | Return only events performed by these actors. Can be a user ID, a service account ID, or an api key tracking ID. (Optional)
#' var_actor_emails <- c("inner_example") # array[character] | Return only events performed by users with these emails. (Optional)
#' var_resource_ids <- c("inner_example") # array[character] | Return only events performed on these targets. For example, a project ID updated. (Optional)
#' var_limit <- 20 # integer | A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 20.  (Optional)
#' var_after <- "after_example" # character | A cursor for use in pagination. `after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include after=obj_foo in order to fetch the next page of the list.  (Optional)
#' var_before <- "before_example" # character | A cursor for use in pagination. `before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with obj_foo, your subsequent call can include before=obj_foo in order to fetch the previous page of the list.  (Optional)
#'
#' #List user actions and configuration changes within this organization.
#' api_instance <- AuditLogsApi$new()
#'
#' # Configure HTTP bearer authorization: ApiKeyAuth
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$ListAuditLogs(effective_at = var_effective_at, project_ids = var_project_ids, event_types = var_event_types, actor_ids = var_actor_ids, actor_emails = var_actor_emails, resource_ids = var_resource_ids, limit = var_limit, after = var_after, before = var_beforedata_file = "result.txt")
#' result <- api_instance$ListAuditLogs(effective_at = var_effective_at, project_ids = var_project_ids, event_types = var_event_types, actor_ids = var_actor_ids, actor_emails = var_actor_emails, resource_ids = var_resource_ids, limit = var_limit, after = var_after, before = var_before)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
AuditLogsApi <- R6::R6Class(
  "AuditLogsApi",
  public = list(
    api_client = NULL,

    #' @description
    #' Initialize a new AuditLogsApi.
    #'
    #' @param api_client An instance of API client.
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },

    #' @description
    #' List user actions and configuration changes within this organization.
    #'
    #' @param effective_at (optional) Return only events whose `effective_at` (Unix seconds) is in this range.
    #' @param project_ids (optional) Return only events for these projects.
    #' @param event_types (optional) Return only events with a `type` in one of these values. For example, `project.created`. For all options, see the documentation for the [audit log object](/docs/api-reference/audit-logs/object).
    #' @param actor_ids (optional) Return only events performed by these actors. Can be a user ID, a service account ID, or an api key tracking ID.
    #' @param actor_emails (optional) Return only events performed by users with these emails.
    #' @param resource_ids (optional) Return only events performed on these targets. For example, a project ID updated.
    #' @param limit (optional) A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 20.  (default value: 20)
    #' @param after (optional) A cursor for use in pagination. `after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include after=obj_foo in order to fetch the next page of the list. 
    #' @param before (optional) A cursor for use in pagination. `before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with obj_foo, your subsequent call can include before=obj_foo in order to fetch the previous page of the list. 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return ListAuditLogsResponse
    ListAuditLogs = function(effective_at = NULL, project_ids = NULL, event_types = NULL, actor_ids = NULL, actor_emails = NULL, resource_ids = NULL, limit = 20, after = NULL, before = NULL, data_file = NULL, ...) {
      local_var_response <- self$ListAuditLogsWithHttpInfo(effective_at, project_ids, event_types, actor_ids, actor_emails, resource_ids, limit, after, before, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' List user actions and configuration changes within this organization.
    #'
    #' @param effective_at (optional) Return only events whose `effective_at` (Unix seconds) is in this range.
    #' @param project_ids (optional) Return only events for these projects.
    #' @param event_types (optional) Return only events with a `type` in one of these values. For example, `project.created`. For all options, see the documentation for the [audit log object](/docs/api-reference/audit-logs/object).
    #' @param actor_ids (optional) Return only events performed by these actors. Can be a user ID, a service account ID, or an api key tracking ID.
    #' @param actor_emails (optional) Return only events performed by users with these emails.
    #' @param resource_ids (optional) Return only events performed on these targets. For example, a project ID updated.
    #' @param limit (optional) A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 20.  (default value: 20)
    #' @param after (optional) A cursor for use in pagination. `after` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include after=obj_foo in order to fetch the next page of the list. 
    #' @param before (optional) A cursor for use in pagination. `before` is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, starting with obj_foo, your subsequent call can include before=obj_foo in order to fetch the previous page of the list. 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (ListAuditLogsResponse) with additional information such as HTTP status code, headers
    ListAuditLogsWithHttpInfo = function(effective_at = NULL, project_ids = NULL, event_types = NULL, actor_ids = NULL, actor_emails = NULL, resource_ids = NULL, limit = 20, after = NULL, before = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (!missing(`effective_at`) && is.null(`effective_at`)) {
        stop("Invalid value for `effective_at` when calling AuditLogsApi$ListAuditLogs, `effective_at` is not nullable")
      }

      if (!missing(`project_ids`) && is.null(`project_ids`)) {
        stop("Invalid value for `project_ids` when calling AuditLogsApi$ListAuditLogs, `project_ids` is not nullable")
      }

      if (!missing(`event_types`) && is.null(`event_types`)) {
        stop("Invalid value for `event_types` when calling AuditLogsApi$ListAuditLogs, `event_types` is not nullable")
      }

      if (!missing(`actor_ids`) && is.null(`actor_ids`)) {
        stop("Invalid value for `actor_ids` when calling AuditLogsApi$ListAuditLogs, `actor_ids` is not nullable")
      }

      if (!missing(`actor_emails`) && is.null(`actor_emails`)) {
        stop("Invalid value for `actor_emails` when calling AuditLogsApi$ListAuditLogs, `actor_emails` is not nullable")
      }

      if (!missing(`resource_ids`) && is.null(`resource_ids`)) {
        stop("Invalid value for `resource_ids` when calling AuditLogsApi$ListAuditLogs, `resource_ids` is not nullable")
      }

      if (!missing(`limit`) && is.null(`limit`)) {
        stop("Invalid value for `limit` when calling AuditLogsApi$ListAuditLogs, `limit` is not nullable")
      }

      if (!missing(`after`) && is.null(`after`)) {
        stop("Invalid value for `after` when calling AuditLogsApi$ListAuditLogs, `after` is not nullable")
      }

      if (!missing(`before`) && is.null(`before`)) {
        stop("Invalid value for `before` when calling AuditLogsApi$ListAuditLogs, `before` is not nullable")
      }

      query_params[["effective_at"]] <- `effective_at`

      # explore
      for (query_item in `project_ids`) {
        query_params[["project_ids[]"]] <- c(query_params[["project_ids[]"]], list(`project_ids[]` = query_item))
      }

      # explore
      for (query_item in `event_types`) {
        query_params[["event_types[]"]] <- c(query_params[["event_types[]"]], list(`event_types[]` = query_item))
      }

      # explore
      for (query_item in `actor_ids`) {
        query_params[["actor_ids[]"]] <- c(query_params[["actor_ids[]"]], list(`actor_ids[]` = query_item))
      }

      # explore
      for (query_item in `actor_emails`) {
        query_params[["actor_emails[]"]] <- c(query_params[["actor_emails[]"]], list(`actor_emails[]` = query_item))
      }

      # explore
      for (query_item in `resource_ids`) {
        query_params[["resource_ids[]"]] <- c(query_params[["resource_ids[]"]], list(`resource_ids[]` = query_item))
      }

      query_params[["limit"]] <- `limit`

      query_params[["after"]] <- `after`

      query_params[["before"]] <- `before`

      local_var_url_path <- "/organization/audit_logs"
      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "ListAuditLogsResponse"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    }
  )
)
