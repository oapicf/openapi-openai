const utils = require('../utils/utils');
const RealtimeConversationItem_content_inner = require('../models/RealtimeConversationItem_content_inner');

module.exports = {
    fields: (prefix = '', isInput = true, isArrayChild = false) => {
        const {keyPrefix, labelPrefix} = utils.buildKeyAndLabel(prefix, isInput, isArrayChild)
        return [
            {
                key: `${keyPrefix}id`,
                label: `The unique ID of the item, this can be generated by the client to help  manage server-side context, but is not required because the server will  generate one if not provided.  - [${labelPrefix}id]`,
                type: 'string',
            },
            {
                key: `${keyPrefix}type`,
                label: `The type of the item (`message`, `function_call`, `function_call_output`).  - [${labelPrefix}type]`,
                type: 'string',
                choices: [
                    'message',
                    'function_call',
                    'function_call_output',
                ],
            },
            {
                key: `${keyPrefix}object`,
                label: `Identifier for the API object being returned - always `realtime.item`.  - [${labelPrefix}object]`,
                type: 'string',
                choices: [
                    'realtime.item',
                ],
            },
            {
                key: `${keyPrefix}status`,
                label: `The status of the item (`completed`, `incomplete`). These have no effect  on the conversation, but are accepted for consistency with the  `conversation.item.created` event.  - [${labelPrefix}status]`,
                type: 'string',
                choices: [
                    'completed',
                    'incomplete',
                ],
            },
            {
                key: `${keyPrefix}role`,
                label: `The role of the message sender (`user`, `assistant`, `system`), only  applicable for `message` items.  - [${labelPrefix}role]`,
                type: 'string',
                choices: [
                    'user',
                    'assistant',
                    'system',
                ],
            },
            {
                key: `${keyPrefix}content`,
                label: `[${labelPrefix}content]`,
                children: RealtimeConversationItem_content_inner.fields(`${keyPrefix}content${!isInput ? '[]' : ''}`, isInput, true), 
            },
            {
                key: `${keyPrefix}call_id`,
                label: `The ID of the function call (for `function_call` and  `function_call_output` items). If passed on a `function_call_output`  item, the server will check that a `function_call` item with the same  ID exists in the conversation history.  - [${labelPrefix}call_id]`,
                type: 'string',
            },
            {
                key: `${keyPrefix}name`,
                label: `The name of the function being called (for `function_call` items).  - [${labelPrefix}name]`,
                type: 'string',
            },
            {
                key: `${keyPrefix}arguments`,
                label: `The arguments of the function call (for `function_call` items).  - [${labelPrefix}arguments]`,
                type: 'string',
            },
            {
                key: `${keyPrefix}output`,
                label: `The output of the function call (for `function_call_output` items).  - [${labelPrefix}output]`,
                type: 'string',
            },
        ]
    },
    mapping: (bundle, prefix = '') => {
        const {keyPrefix} = utils.buildKeyAndLabel(prefix)
        return {
            'id': bundle.inputData?.[`${keyPrefix}id`],
            'type': bundle.inputData?.[`${keyPrefix}type`],
            'object': bundle.inputData?.[`${keyPrefix}object`],
            'status': bundle.inputData?.[`${keyPrefix}status`],
            'role': bundle.inputData?.[`${keyPrefix}role`],
            'content': utils.childMapping(bundle.inputData?.[`${keyPrefix}content`], `${keyPrefix}content`, RealtimeConversationItem_content_inner),
            'call_id': bundle.inputData?.[`${keyPrefix}call_id`],
            'name': bundle.inputData?.[`${keyPrefix}name`],
            'arguments': bundle.inputData?.[`${keyPrefix}arguments`],
            'output': bundle.inputData?.[`${keyPrefix}output`],
        }
    },
}
